<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Gestion des tâches</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--<link rel="stylesheet" href="StyleSheet.css" type="text/css">-->

<script language="JavaScript1.2">
  function ajout(listeDep) {
    var existe = 0; 
    if(listeDep.options[listeDep.selectedIndex].value == 0){ } 
    else
    { 
      for(i=0;i< document.getElementById('selectArtefactEntreeChoisi').length ;i++)
      { 
        if(document.getElementById('selectArtefactEntreeChoisi').options[i].text == listeDep.options[listeDep.selectedIndex].text)
        { 
          existe = 1; 
        } 
        else 
        { 
          if(existe == 1)
          { 
            existe = 1; 
          } 
          else 
          { 
            existe = 0; 
          } 
        } 
      } 
      if(existe == 0)
      { 
        var option = new Option(listeDep.options[listeDep.selectedIndex].text,listeDep.options[listeDep.selectedIndex].value); 
        document.getElementById('selectArtefactEntreeChoisi').options[(document.getElementById('selectArtefactEntreeChoisi').length)] = option; 
        if ( document.getElementById('selectArtefactEntreeChoisi').length < document.getElementById('selectArtefactEntree').length) 
        {
		      document.getElementById('selectArtefactEntreeChoisi').size = document.getElementById('selectArtefactEntree').length;
        }
	    } 
      else
      { 
        alert('Cet artefact est déjà séléctionné !!!'); 
      } 
    }
  } 

  function enleve(listeArr)
  { 
    if(listeArr.options[listeArr.selectedIndex].value == 0){ } 
    else
    { 
      listeArr.options[listeArr.selectedIndex] = null; 
    }
  }
  
	/**Méthode vérifiant que le champ soit bien une date*/
  function isDate(valeur)
  {
    var re = /^\d{1}\d{1}\/\d{1}\d{1}\/\d{1}\d{1}\d{1}\d{1}$/;
    if(!re.test(valeur))
    {
      return false;
     }
     return true;
  }
	
  function isEmpty(valeur)
  {
    var re = /^\S+$/;
    if(!re.test(valeur))
    {
      return false;
    }
    return true;
  }

  /**Méthode vérifiant que la valeur saisie soit bien un entier*/
  function isInteger(valeur)
  {
    var re = /^\d+$/;   
    if(!re.test(valeur))
    {
      return false;
   }
   return true;
  }


  function fenetreNouveauArtefact () 
  {
    window.open("NouvelArtefact.htm","PopUp",'width=500,height=210,location=no,status=no,toolbar=no,scrollbars=no');
  }
  
  function verifSaisie ()
  {
    var lSaisieCorrect = 1;
		
		if (!isEmpty(this.document.getElementById('textfieldNomTache').value)) 
    {
      lSaisieCorrect = 0;
			alert('Nom de la tache non saisie');
    }
		else if (!isEmpty(this.document.getElementById('textfieldDateDebutTache').value)) 
    {
      lSaisieCorrect = 0;
			alert('Date début non saisie');
    }
		else if (!isDate(this.document.getElementById('textfieldDateDebutTache').value)) 
    {
      lSaisieCorrect = 0;
			alert('Date de début incorrect');
    }
		else if (!isEmpty(this.document.getElementById('textfieldDateFinTache').value)) 
    {
      lSaisieCorrect = 0;
			alert('Date fin non saisie');
    }
		else if (!isDate(this.document.getElementById('textfieldDateFinTache').value)) 
    {
      lSaisieCorrect = 0;
			alert('Date de fin incorrect');
    }
		else if (!isEmpty(this.document.getElementById('textfieldChargeCollaborateur').value)) 
    {
      lSaisieCorrect = 0;
			alert('Charge non saisie');
    }
		else if (!isInteger(this.document.getElementById('textfieldChargeCollaborateur').value)) 
    {
      lSaisieCorrect = 0;
			alert('Charge incorrecte');
    }
    else if (this.document.getElementById('textfieldChargeCollaborateur').value < 0 ) 
    {
      lSaisieCorrect = 0;
			alert('Charge incorrecte');
    }
		/*else if (this.document.getElementById('selectArtefactSortie').options[0].text))
    {
      lSaisieCorrect = 0;
      alert('Artefact de sortie non saisie');
    }*/
	} 
	
  function ajoutNouvelArtefact (listArr) {
	  var existe = 0; 
    for(i=0;i< listArr.length ;i++)
    { 
      if(listArr.options[i].text == document.getElementById('textfieldNomArtefact').value)
      { 
        existe = 1; 
      } 
      else 
      { 
        if(existe == 1)
        { 
          existe = 1; 
        } 
        else 
        { 
          existe = 0; 
        } 
      } 
    } 
    if(existe == 0)
    {
	    var option = new Option(document.getElementById('textfieldNomArtefact').value,document.getElementById('textfieldNomArtefact').value); 
      listArr.options[(listArr.length)] = option; 
    }
    else
    {
      alert('Cet artefact est déjà présent.');
		}
	}
</script>

</head>

<body>
  <form name="formAjoutTache" method="post" action="">
    
    <fieldset >
      <legend> Tâche </legend>
      <table width="75%" border="0">
        <tr>
          <td>Lié à l'activit&eacute; : </td>
          <td>
            <select name="selectActivite" size ="1">
                <option VALUE="activite1"> Définir l'IHM </option>
                <option VALUE="activite2"> Spécifier les cas d'utilisation </option>
                <option VALUE="aucune"> Aucune </option>
              </select>
          </td>
        </tr>
        <tr>
          <td>Nom de la tâche : </td>
          <td><input type="text" name="textfieldNomTache"></td>
        </tr>

        <tr>
          <td>Description : </td>
          <td><textarea name="textareaDescriptionActivite"></textarea></td>
        </tr>
        <tr>
          <td> Date de début : </td>
	      <td><input type="text" name="textfieldDateDebutTache"></td>
        </tr>
        <tr>
          <td> Date de fin : </td>
	        <td><input type="text" name="textfieldDateFinTache"></td>
        </tr>
        <tr>
          <td>
            Collaborateur :
          </td>
          <td>
            <select name="selectCollaborateur" size="1">
              <option VALUE="collab1"> Yann Albac </option>
              <option VALUE="collab2"> Laure Bosse </option>
              <option VALUE="collab3"> Rémi Joffre </option>
              <option VALUE="collab4"> Victor Nancy </option>
              <option VALUE="collab5"> Sylvain Ratabouil </option>
            </select>          
            &nbsp;&nbsp;Charge : <input type="text" name="textfieldChargeCollaborateur" size="3">
          </td>
        </tr>
      </table>
    </fieldset>
    
    <fieldset>
      <legend> Artefacts en entrée </legend>
      <table width="30%" border="0" align="center">
        <tr>
          <td rowspan="2"  width="25%">
            <center>
              <select name="selectArtefactEntree" size="3" multiple ondblclick="ajout(this)">
                <option VALUE="artefact1"> Architecture </option>
                <option VALUE="artefact2"> Modèle de cas d'utilisation </option>
                <option VALUE="artefact3"> PDL </option>
              </select>
            </center>
          </td>
          <td>
            <center>
              <input type="button" name="buttonAjouterArtefactEntree" value=">" onClick="ajout(formAjoutTache.selectArtefactEntree)">
            </center>
          </td>
          <td rowspan="2"  width="25%">
            <center>
              <select name="selectArtefactEntreeChoisi" size="3" ondblclick="enleve(this)" >
              </select>
            </center>
          </td>
        </tr>
        <tr>
          <td>
            <center>
              <input type="button" name="buttonRetirerArtefactEntree" value="<" onclick="enleve(formAjoutTache.selectArtefactEntreeChoisi)">
            </center>
          </td>
        </tr>
      </table>
    </fieldset>
			
    <fieldset>
      <legend> Artefacts en sortie </legend>
      <center>        
          <table width="50%" border="0" align="center">
            <tr>
              <td> Nom de l'artefact : </td>  
              <td>
                <input type="text" name="textfieldNomArtefact">
              </td>
              <td rowspan="2">
                <input name="buttonAjouterNouvelArtefact" type="button" value=">" onclick="ajoutNouvelArtefact (formAjoutTache.selectArtefactSortie)">
                <br>
                <input name="buttonRetirerNouvelArtefact" type="button" value="<" onclick="enleve (formAjoutTache.selectArtefactSortie)">
              </td>
              <td rowspan="2">
					      <select name="selectArtefactSortie" size="3">
                </select>		
              </td>
            </tr>
            <tr>
              <td>Lié à un produit :</td>
              <td>
                <select name="selectProduit" size="1">
                  <option VALUE="prod1"> Produit1 </option>
                  <option VALUE="prod2"> Produit2 </option>
                  <option VALUE="prod3"> Produit3 </option>
                  <option VALUE="prod4"> Produit4 </option>
                  <option VALUE="prod5"> Produit5 </option>
                </select>
              </td>
            </tr>
          </table>
      </center>
    </fieldset>
	
    <br>
    <center>
      <input name="buttonValiderGestionTache" type="button" value="Valider" onClick="verifSaisie()">&nbsp;
      <input name="buttonAnnulerGestionTache" type="button" value="Annuler">
    </center>
	
  </form>

</body>
</html>
