<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Nouvel Artefact</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<script language="JavaScript1.2">
  function ajoutArtefactSortie () {
    var existe = 0; 
    window.confirm('1');
		for(i=0;i< window.opener.document.forms["formAjoutTache"].elements["selectArtefactSortie"].length ;i++){ 
      if(window.opener.document.forms["formAjoutTache"].elements["selectArtefactSortie"].options[i].text == this.document.getElementById('textfieldNomArtefact').value){ 
        existe = 1; 
      } 
      else { 
        if(existe == 1){ 
          existe = 1; 
        } 
        else { 
          existe = 0; 
        } 
      } 
    } 
    if(existe == 0){ 
      window.confirm('2');
			var option = new Option(this.document.getElementById('textfieldNomArtefact').value,this.document.getElementById('textfieldNomArtefact').value); 
      window.confirm('dededd');
			<!--window.opener.document.getElementById('selectArtefactSortie').options[(window.opener.document.getElementById('selectArtefactSortie').length)] = option; -->
      <!--window.opener.document.forms["formAjoutTache"].elements["selectArtefactSortie"].options[(window.opener.document.forms["formAjoutTache"].elements["selectArtefactSortie"].length)] = option;	-->
		  <!--window.opener.document.forms["formAjoutTache"].elements["textfieldNomTache"].value=this.document.getElementById('textfieldNomArtefact').value;-->
			window.opener.document.getElementById('selectArtefactSortie').options[(window.opener.document.getElementById('selectArtefactSortie').length)] = option; 
			window.confirm('3');
		} 
    else{ 
      alert('Cet artefact est déjà présent en sortie !!!'); 
    }
  window.confirm('4');
	window.close(); 
  }
	
  /**Méthode vérifiant que le champ ne soit pas vide*/
  function isEmpty(valeur)
  {
    var re = /^\S+$/;
    if(!re.test(valeur))
    {
      return false;
    }
    return true;
  }
	
	function verifSaisie () {
    var saisieCorrect = 1;
		if (!isEmpty(this.document.getElementById('textfieldNomArtefact').value))
    {
		  saisieCorrect = 0;
			alert('Nom artefact non saisie');
    }
		if (saisieCorrect == 1)
    {
		  ajoutArtefactSortie();
    }
  }
</script>


</head>

<body>
  <fieldset>
    <legend> Nouvel Artefact </legend>
    <form name="formNouvelArtefact" method="post" action="">
      <table width="75%" border="0">
        <tr>        
          <td> Lié à un produit :</td>
          <td>
            <select name="selectProduit" size="1">
                <option VALUE="prod1"> Produit1 </option>
                <option VALUE="prod2"> Produit2 </option>
                <option VALUE="prod3"> Produit3 </option>
                <option VALUE="prod4"> Produit4 </option>
                <option VALUE="prod5"> Produit5 </option>
              </select>
          </td>
        </tr>
        <tr>
          <td>Nom de l'artefact :</td>
          <td>
            <input type="text" name="textfieldNomArtefact">
          </td>
        </tr>
        <tr>          
          <td>Description :</td>
          <td>
            <textarea name="textareaDescription"></textarea>
          </td>
        </tr>        
      </table>
    
      <center>
        <input name="buttonValiderNouveauProduit" type="button" value="Valider" onClick="verifSaisie()">&nbsp;
        <input name="buttonAnnulerNouveauProduit" type="button" value="Annuler">
      </center>
    </form>
  </fieldset>
</body>
</html>
